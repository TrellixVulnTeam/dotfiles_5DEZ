#!/bin/bash
#############################################################
# Author: Amila Perera
# File Name: .bash_comp
# Last Modified: Thu Feb 28, 2013  10:50PM
#############################################################


#comp_dir=/etc/bash_completion.d
#if [ -d $comp_dir ]; then
#	for file in $comp_dir/*; do
#		# source everything in the directory and ignore the errors
#		[ -f $file ] && source $file 2>/dev/null
#	done
#fi

[ -f /etc/bash_completion ] && source /etc/bash_completion

[ -f $HOME/.bin/tmuxinator_completion ] && source $HOME/.bin/tmuxinator_completion

comp_file=/usr/share/bash-completion/bash_completion
[ -f $comp_file ] && source $comp_file

complete -F _fbm_comp fbm F   # completion function for folder bookmark utility

complete -o dirnames -f -X '!*.@(?([xX]|[sS])[hH][tT][mM]?([lL]))' ff cb
complete -o dirnames -f -X '!*.[pf]df' pdf

function _fbm_comp()
{
	local file="$HOME/.fbookmarks"
	local cur=
	COMPREPLY=()
	cur=${COMP_WORDS[$COMP_CWORD]}
	if (( $COMP_CWORD == 1 )); then
		if [ -f $file ]; then
			COMPREPLY=( $(compgen -W "$(awk -F':' '{ print $1 }' $file) -c -d -r -m -e -l -h" -- "${cur}") )
		else
			COMPREPLY=( $(compgen -W "-c -h" -- "${cur}") )
		fi
	elif (( $COMP_CWORD == 2 )) && [[ ${COMP_WORDS[1]} =~ -[rm] ]]; then
		COMPREPLY=( $(compgen -W "$(awk -F':' '{ print $1 }' $file)" -- "${cur}") )
	elif (( $COMP_CWORD >= 2 )) && [[ ${COMP_WORDS[1]} =~ -[de] ]]; then
		COMPREPLY=( $(compgen -W "$(awk -F':' '{ print $1 }' $file)" -- "${cur}") )
	elif (( $COMP_CWORD == 3 )) && [[ ${COMP_WORDS[1]} =~ -[cm] ]]; then
		_filedir -d
	fi
}
